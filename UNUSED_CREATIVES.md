# üéØ UNUSED CREATIVES –°–ò–°–¢–ï–ú–ê

## üìã –û–ë–ó–û–†

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–Ω—ã–º–∏ –∫–∞–º–ø–∞–Ω–∏—è–º–∏. –í–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–∞–º–ø–∞–Ω–∏–π, Brain Agent —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –≥–æ—Ç–æ–≤—ã–º–∏ –∫—Ä–µ–∞—Ç–∏–≤–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è—Ö.

---

## üéØ –ü–†–û–ë–õ–ï–ú–ê –ö–û–¢–û–†–£–Æ –†–ï–®–ê–ï–ú

### –î–û:
- ‚ùå Brain Agent –¥—É–±–ª–∏—Ä–æ–≤–∞–ª –∫–∞–º–ø–∞–Ω–∏–∏ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –±—ã–ª–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ùå –ì–æ—Ç–æ–≤—ã–µ –∫—Ä–µ–∞—Ç–∏–≤—ã –≤ –±–∞–∑–µ `user_creatives` –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå –¢–µ–∫—É—â–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞–ª–∏ —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞ –æ–¥–Ω—É –∞—É–¥–∏—Ç–æ—Ä–∏—é
- ‚ùå –û–±—É—á–µ–Ω–∏–µ Facebook Ads –ø—Ä–µ—Ä—ã–≤–∞–ª–æ—Å—å –ø—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏

### –ü–û–°–õ–ï:
- ‚úÖ Scoring Agent –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–∏–µ –∫—Ä–µ–∞—Ç–∏–≤—ã –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö ads
- ‚úÖ Brain Agent —Å–æ–∑–¥–∞–µ—Ç –ù–û–í–£–Æ –∫–∞–º–ø–∞–Ω–∏—é –≤–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –¢–µ–∫—É—â–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –æ–±—É—á–µ–Ω–∏–µ –±–µ–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### 1. **Scoring Agent** (services/agent-brain/src/scoring.js)

#### –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: `getActiveCreativeIds()`

```javascript
async function getActiveCreativeIds(adAccountId, accessToken) {
  // 1. –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ ads –∏–∑ Facebook Graph API
  const ads = await fetch(`${FB_API_VERSION}/${adAccountId}/ads?fields=creative{id}`);
  
  // 2. –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ ACTIVE ads
  const activeAds = ads.filter(ad => 
    ad.status === 'ACTIVE' && ad.effective_status === 'ACTIVE'
  );
  
  // 3. –í–æ–∑–≤—Ä–∞—â–∞–µ–º Set —Å creative IDs
  return new Set(activeAds.map(ad => ad.creative?.id));
}
```

#### –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤:

```javascript
const unusedCreatives = [];

for (const creative of userCreatives) {
  // –í—Å–µ fb_creative_id —ç—Ç–æ–≥–æ –∫—Ä–µ–∞—Ç–∏–≤–∞
  const creativeIds = [
    creative.fb_creative_id_whatsapp,
    creative.fb_creative_id_instagram_traffic,
    creative.fb_creative_id_site_leads
  ].filter(id => id);
  
  // –ï—Å–ª–∏ –ù–ò –û–î–ò–ù –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö ads
  const isUnused = creativeIds.length > 0 && 
                   !creativeIds.some(id => activeCreativeIds.has(id));
  
  if (isUnused) {
    unusedCreatives.push({
      id: creative.id,
      title: creative.title,
      fb_creative_id_whatsapp: creative.fb_creative_id_whatsapp,
      fb_creative_id_instagram_traffic: creative.fb_creative_id_instagram_traffic,
      fb_creative_id_site_leads: creative.fb_creative_id_site_leads,
      recommended_objective: 'WhatsApp', // –ù–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ª–∏—á–∏—è –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
      created_at: creative.created_at
    });
  }
}
```

#### –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ `scoringRawData`:

```javascript
const scoringRawData = {
  adsets: adsetsWithTrends,
  ready_creatives: readyCreatives,
  unused_creatives: unusedCreatives  // üÜï –ù–û–í–û–ï!
};
```

---

### 2. **Brain Agent Prompt** (services/agent-brain/src/server.js)

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

```
scoring: {
  summary: { ... },
  items: [ ... ],
  active_creatives_ready: [ ... ],
  unused_creatives: [              // üÜï –ù–û–í–û–ï!
    {
      id: "uuid",
      title: "–ù–∞–∑–≤–∞–Ω–∏–µ –∫—Ä–µ–∞—Ç–∏–≤–∞",
      fb_creative_id_whatsapp: "123...",
      fb_creative_id_instagram_traffic: "456...",
      fb_creative_id_site_leads: "789...",
      recommended_objective: "WhatsApp",
      created_at: "2025-10-05T10:00:00Z"
    }
  ],
  recommendations_for_brain: [ ... ]
}
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è LLM:

**–ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ SCORING DATA:**

```
3. **–ù–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫—Ä–µ–∞—Ç–∏–≤—ã (–ö–õ–Æ–ß–ï–í–û–ï!)**:
   - –ï—Å–ª–∏ –≤ unused_creatives –µ—Å—Ç—å –∫—Ä–µ–∞—Ç–∏–≤—ã ‚Üí —Ä–∞—Å—Å–º–æ—Ç—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ù–û–í–û–ô –∫–∞–º–ø–∞–Ω–∏–∏ 
     —á–µ—Ä–µ–∑ CreateCampaignWithCreative –í–ú–ï–°–¢–û –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
   - –≠—Ç–æ –¥–∞–µ—Ç —à–∞–Ω—Å —Ç–µ–∫—É—â–∏–º –∫–∞–º–ø–∞–Ω–∏—è–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ + —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π 
     –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
```

**CreateCampaignWithCreative –¥–µ–π—Å—Ç–≤–∏–µ:**

```
–ö–û–ì–î–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨:
(1) –µ—Å–ª–∏ –≤ scoring.unused_creatives –µ—Å—Ç—å –∫—Ä–µ–∞—Ç–∏–≤—ã ‚Äî —Å–æ–∑–¥–∞–π –∫–∞–º–ø–∞–Ω–∏—é –í–ú–ï–°–¢–û 
    –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π, –∏—Å–ø–æ–ª—å–∑—É—è recommended_objective –∏–∑ unused_creatives
(2) –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ —Ç–µ–∫—É—â–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏ ‚Äî —Å–æ–∑–¥–∞–π –Ω–æ–≤—É—é 
    –≤–º–µ—Å—Ç–æ –∞–ø–∞ –±—é–¥–∂–µ—Ç–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
```

---

## üîÑ WORKFLOW

### –ü—Ä–∏–º–µ—Ä 1: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º –∫—Ä–µ–∞—Ç–∏–≤–æ–º

```
–°–∏—Ç—É–∞—Ü–∏—è:
- –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 3 –∫—Ä–µ–∞—Ç–∏–≤–∞ –≤ user_creatives
- 1 –∫—Ä–µ–∞—Ç–∏–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ (CPL=300‚ÇΩ)
- 2 –∫—Ä–µ–∞—Ç–∏–≤–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

Scoring Agent –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
{
  "unused_creatives": [
    {
      "id": "abc-123",
      "title": "–ù–æ–≤–æ–µ –≤–∏–¥–µ–æ –ø—Ä–æ —É—Å–ª—É–≥–∏",
      "recommended_objective": "WhatsApp"
    },
    {
      "id": "def-456",
      "title": "–ê–∫—Ü–∏—è —Å–µ–Ω—Ç—è–±—Ä—è",
      "recommended_objective": "WhatsApp"
    }
  ]
}

Brain Agent —Ä–µ—à–∞–µ—Ç:
1. ‚ùå –ù–ï –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –∫–∞–º–ø–∞–Ω–∏—é
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞–º–ø–∞–Ω–∏—é —Å –∫—Ä–µ–∞—Ç–∏–≤–æ–º "abc-123"
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CreateCampaignWithCreative —Å auto_activate=true

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- –°—Ç–∞—Ä–∞—è –∫–∞–º–ø–∞–Ω–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ ‚Üí CPL –º–æ–∂–µ—Ç —É–ª—É—á—à–∞—Ç—å—Å—è
- –ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å –Ω–æ–≤—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º ‚Üí —Å–≤–µ–∂–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
- –ù–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –º–µ–∂–¥—É –∫–∞–º–ø–∞–Ω–∏—è–º–∏ –∑–∞ –æ–¥–Ω—É –∞—É–¥–∏—Ç–æ—Ä–∏—é
```

---

### –ü—Ä–∏–º–µ—Ä 2: –ù–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

```
–°–∏—Ç—É–∞—Ü–∏—è:
- –í—Å–µ –∫—Ä–µ–∞—Ç–∏–≤—ã –∏–∑ user_creatives –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö ads

Scoring Agent –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
{
  "unused_creatives": []
}

Brain Agent —Ä–µ—à–∞–µ—Ç:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ/–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
2. ‚úÖ –ò–ª–∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
```

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•

### user_creatives (Supabase)

```sql
CREATE TABLE user_creatives (
  id UUID PRIMARY KEY,
  user_id UUID NOT NULL,
  title TEXT NOT NULL,
  fb_video_id TEXT,
  fb_creative_id_whatsapp TEXT,           -- Creative –¥–ª—è WhatsApp
  fb_creative_id_instagram_traffic TEXT,  -- Creative –¥–ª—è Instagram Traffic
  fb_creative_id_site_leads TEXT,         -- Creative –¥–ª—è Site Leads
  is_active BOOLEAN DEFAULT true,
  status TEXT DEFAULT 'ready',
  created_at TIMESTAMPTZ DEFAULT NOW()
);
```

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è unused_creatives:

1. ‚úÖ `is_active = true`
2. ‚úÖ `status = 'ready'`
3. ‚úÖ –•–æ—Ç—è –±—ã –æ–¥–∏–Ω `fb_creative_id_*` –∑–∞–ø–æ–ª–Ω–µ–Ω
4. ‚úÖ **–ù–ò –û–î–ò–ù** –∏–∑ `fb_creative_id_*` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö ads

---

## üéØ –õ–û–ì–ò–ö–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò OBJECTIVE

```javascript
let recommendedObjective = 'WhatsApp'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é

if (creative.fb_creative_id_whatsapp) {
  recommendedObjective = 'WhatsApp';
} else if (creative.fb_creative_id_instagram_traffic) {
  recommendedObjective = 'Instagram';
} else if (creative.fb_creative_id_site_leads) {
  recommendedObjective = 'SiteLeads';
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** WhatsApp > Instagram > SiteLeads

---

## üöÄ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° CreateCampaignWithCreative

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ–π—Å—Ç–≤–∏—è:

```typescript
{
  user_creative_id: string;         // ID –∏–∑ unused_creatives
  objective: ObjectiveType;         // recommended_objective
  campaign_name: string;
  daily_budget_cents: number;
  use_default_settings?: boolean;   // true = –∞–≤—Ç–æ —Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥
  auto_activate?: boolean;          // true = —Å—Ä–∞–∑—É –∑–∞–ø—É—Å–∫
}
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞ Brain Agent:

```json
{
  "tool": "CreateCampaignWithCreative",
  "params": {
    "user_creative_id": "abc-123",
    "objective": "WhatsApp",
    "campaign_name": "–ù–æ–≤—ã–π –∫—Ä–µ–∞—Ç–∏–≤ - –£—Å–ª—É–≥–∏",
    "daily_budget_cents": 50000,
    "use_default_settings": true,
    "auto_activate": true
  }
}
```

---

## üìà –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

### 1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è Facebook Ads**
- –¢–µ–∫—É—â–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
- –ê–ª–≥–æ—Ä–∏—Ç–º Facebook –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–∏
- –£–ª—É—á—à–µ–Ω–∏–µ CPL —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –≤–º–µ—Å—Ç–æ "—Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞"

### 2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
- –ú–∏–Ω–∏–º—É–º —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –ø–æ—è–≤–ª–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### 3. **–ò–∑–±–µ–∂–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏**
- –ù–µ—Ç –±–æ—Ä—å–±—ã –º–µ–∂–¥—É –∫–∞–º–ø–∞–Ω–∏—è–º–∏ –∑–∞ –æ–¥–Ω—É –∞—É–¥–∏—Ç–æ—Ä–∏—é
- –ö–∞–∂–¥–∞—è –∫–∞–º–ø–∞–Ω–∏—è –Ω–∞—Ö–æ–¥–∏—Ç —Å–≤–æ—é —Ü–µ–ª–µ–≤—É—é –≥—Ä—É–ø–ø—É
- –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞

### 4. **–î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π**
- Scoring Agent —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- Brain Agent –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

---

## üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –õ–û–ì–ò

### Scoring Agent –ª–æ–≥–∏:

```javascript
logger.info({ 
  where: 'scoring_agent', 
  phase: 'creatives_fetched', 
  total_creatives: userCreatives.length,
  active_in_ads: activeCreativeIds.size  // –°–∫–æ–ª—å–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
});

logger.info({ 
  where: 'scoring_agent', 
  phase: 'unused_creatives_identified',
  count: unusedCreatives.length  // –°–∫–æ–ª—å–∫–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
});
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```json
{
  "where": "scoring_agent",
  "phase": "creatives_fetched",
  "total_creatives": 5,
  "active_in_ads": 8
}

{
  "where": "scoring_agent",
  "phase": "unused_creatives_identified",
  "count": 2
}
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∫—Ä–µ–∞—Ç–∏–≤
INSERT INTO user_creatives (
  id, user_id, title, 
  fb_creative_id_whatsapp, 
  is_active, status
) VALUES (
  gen_random_uuid(),
  '0f559eb0-53fa-4b6a-a51b-5d3e15e5864b',
  '–¢–µ—Å—Ç–æ–≤—ã–π –∫—Ä–µ–∞—Ç–∏–≤ - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è',
  '123456789',
  true,
  'ready'
);
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Scoring Agent:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å scoring agent
curl -X POST http://localhost:9091/api/scoring/run \
  -H "Content-Type: application/json" \
  -d '{"user_id": "0f559eb0-53fa-4b6a-a51b-5d3e15e5864b"}'
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:

```json
{
  "unused_creatives": [
    {
      "id": "...",
      "title": "–¢–µ—Å—Ç–æ–≤—ã–π –∫—Ä–µ–∞—Ç–∏–≤ - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è",
      "recommended_objective": "WhatsApp"
    }
  ]
}
```

### 4. –¢–µ—Å—Ç Brain Agent:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å brain agent
curl -X POST http://localhost:9091/api/brain/run \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "0f559eb0-53fa-4b6a-a51b-5d3e15e5864b",
    "dispatch": true
  }'
```

---

## üìù CHANGELOG

### v2.0 (2025-10-05)

#### ‚ú® –ù–æ–≤–æ–µ:
- –§—É–Ω–∫—Ü–∏—è `getActiveCreativeIds()` –≤ scoring.js
- –ü–æ–ª–µ `unused_creatives` –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö Scoring Agent
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç Brain Agent —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ `unused_creatives`
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –Ω–∞–¥ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º

#### üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ:
- `getActiveCreatives()` —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `created_at`
- Fallback –¥–∞–Ω–Ω—ã–µ –≤ server.js –≤–∫–ª—é—á–∞—é—Ç `unused_creatives: []`
- CreateCampaignWithCreative –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

#### üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ:
- ‚ùå –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ "—É—Ç—Ä–æ" –∏ "created_at —Å–µ–≥–æ–¥–Ω—è/–≤—á–µ—Ä–∞" –∏–∑ –ø—Ä–æ–º–ø—Ç–∞
- ‚ùå –ù–µ—Ç–æ—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π

---

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –§–ê–ô–õ–´

- `services/agent-brain/src/scoring.js` - Scoring Agent –ª–æ–≥–∏–∫–∞
- `services/agent-brain/src/server.js` - Brain Agent –ø—Ä–æ–º–ø—Ç
- `services/agent-service/src/workflows/createCampaignWithCreative.ts` - Workflow
- `DEFAULT_AD_SETTINGS.md` - –°–∏—Å—Ç–µ–º–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `CAMPAIGN_TIMING.md` - –õ–æ–≥–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã –∫–∞–º–ø–∞–Ω–∏–π
- `BRAIN_PROMPT_CHANGES.md` - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ–º–ø—Ç–∞

---

## üéì FAQ

### Q: –ß—Ç–æ –µ—Å–ª–∏ –í–°–ï –∫—Ä–µ–∞—Ç–∏–≤—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è?
**A:** Scoring Agent –≤–µ—Ä–Ω–µ—Ç `unused_creatives: []`, Brain Agent –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è/–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.

### Q: –ú–æ–∂–µ—Ç –ª–∏ –æ–¥–∏–Ω –∫—Ä–µ–∞—Ç–∏–≤ –±—ã—Ç—å "—á–∞—Å—Ç–∏—á–Ω–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º"?
**A:** –ù–µ—Ç. –ï—Å–ª–∏ –•–û–¢–Ø –ë–´ –û–î–ò–ù –∏–∑ `fb_creative_id_*` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–º ad, –≤–µ—Å—å –∫—Ä–µ–∞—Ç–∏–≤ —Å—á–∏—Ç–∞–µ—Ç—Å—è "–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º".

### Q: –ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –∫—Ä–µ–∞—Ç–∏–≤–æ–≤?
**A:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ Scoring Agent (–æ–±—ã—á–Ω–æ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ä–µ—à–µ–Ω–∏–µ–º Brain Agent).

### Q: –ß—Ç–æ –µ—Å–ª–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è –Ω–æ –æ–Ω–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è?
**A:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `auto_activate: true` –≤ CreateCampaignWithCreative –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –≤—Ä—É—á–Ω—É—é –ø–æ–º–µ—Ç–∏—Ç—å –∫—Ä–µ–∞—Ç–∏–≤ –∫–∞–∫ "–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è"?
**A:** –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —ç—Ç–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö ads –≤ Facebook.

---

## ‚úÖ –ò–¢–û–ì–û

**–ß–¢–û –°–î–ï–õ–ê–ù–û:**
1. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Scoring Agent –∏ Brain Agent
3. ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –Ω–∞–¥ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
4. ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –ø—Ä–∏–º–µ—Ä—ã

**–†–ï–ó–£–õ–¨–¢–ê–¢:**
- –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
- –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ Facebook Ads
- –ú–∏–Ω–∏–º—É–º —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- –ú–∞–∫—Å–∏–º—É–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

üìÖ **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 5 –æ–∫—Ç—è–±—Ä—è 2025  
üë§ **–ê–≤—Ç–æ—Ä:** Agent System  
üîÑ **–í–µ—Ä—Å–∏—è:** 2.0
