# –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è" ‚úÖ ‚ùå

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û

### **1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase)**
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è `008_account_directions.sql` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `account_directions`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è `009_add_objective_to_directions.sql` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è `objective`
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (service_role –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø)
- ‚úÖ –°–≤—è–∑—å —Å `user_creatives` —á–µ—Ä–µ–∑ `direction_id`

### **2. Backend API**
- ‚úÖ `services/agent-service/src/routes/directions.ts` ‚Äî 4 endpoint'–∞:
  - GET `/api/directions` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  - POST `/api/directions` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ + Facebook Campaign
  - PATCH `/api/directions/:id` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  - DELETE `/api/directions/:id` ‚Äî —É–¥–∞–ª–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Facebook Campaign –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏: `[{name}] {objective_readable}` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `[–ò–º–ø–ª–∞–Ω—Ç–∞—Ü–∏—è] WhatsApp`)
- ‚úÖ –°–µ—Ä–≤–∏—Å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ `server.ts`

### **3. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
- ‚úÖ `nginx.conf` –æ–±–Ω–æ–≤–ª—ë–Ω (–ø–æ—Ä—Ç 8082)
- ‚úÖ Docker compose –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### **4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**
- ‚úÖ `DIRECTIONS_FRONTEND_SPEC.md` ‚Äî –ø–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è UI
- ‚úÖ `DIRECTIONS_FRONTEND_INTEGRATION.md` ‚Äî –≥–æ—Ç–æ–≤—ã–π –∫–æ–¥ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ `DIRECTIONS_DEPLOY_CHECKLIST.md` ‚Äî —á–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è

### **5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ (http://localhost:8082)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è Facebook Campaign
- ‚úÖ GET /api/directions –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## ‚ùå –ß–¢–û –ù–ï –°–î–ï–õ–ê–ù–û

### **1. Brain Agent (–≥–ª–∞–≤–Ω—ã–π LLM –∞–≥–µ–Ω—Ç) ‚Äî –ù–ï –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù!**

‚ùå Brain Agent **–ù–ï –ó–ù–ê–ï–¢** –ø—Ä–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è!

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `getUserDirections(userAccountId)` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
2. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫—Ä–µ–∞—Ç–∏–≤—ã –ø–æ `direction_id` (—Ç–æ–ª—å–∫–æ –∫—Ä–µ–∞—Ç–∏–≤—ã –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
3. –û–±–Ω–æ–≤–∏—Ç—å `llmInput`:
   ```javascript
   directions: [  // —Å–ø–∏—Å–æ–∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
     {
       id, name, objective, fb_campaign_id,
       daily_budget_cents, target_cpl_cents
     }
   ],
   campaigns: [
     {
       ...existing_fields,
       direction_id,  // –ø—Ä–∏–≤—è–∑–∫–∞ –∫–∞–º–ø–∞–Ω–∏–∏ –∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é
       direction_name,
       direction_daily_budget_cents,
       direction_target_cpl_cents
     }
   ]
   ```
4. –û–±–Ω–æ–≤–∏—Ç—å SYSTEM_PROMPT:
   - –£–ø–æ–º—è–Ω—É—Ç—å —á—Ç–æ —É –∫–ª–∏–µ–Ω—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø
   - –ö–∞–∂–¥–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ = Facebook Campaign —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º ID
   - –ë—é–¥–∂–µ—Ç—ã —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ü–û –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø–ú (–Ω–µ –æ–±—â–∏–π –±—é–¥–∂–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞)
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Ad Sets –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `fb_campaign_id` –∏–∑ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
5. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `getDirectionByCampaignId(campaignId)` –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ Campaign ‚Üí Direction

**–ì–¥–µ –≤ –∫–æ–¥–µ:**
- `services/agent-brain/src/server.js`
- –§—É–Ω–∫—Ü–∏—è `/api/brain/run`
- SYSTEM_PROMPT (—Å—Ç—Ä–æ–∫–∞ ~777)

---

### **2. Campaign Builder ‚Äî –†–ï–®–ï–ù–ò–ï –ü–†–ò–ù–Ø–¢–û**

‚úÖ **Campaign Builder –æ—Å—Ç–∞—ë—Ç—Å—è –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π!**

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- Campaign Builder —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –¥–ª—è **legacy** (–∫–æ–≥–¥–∞ –Ω–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
- –û–Ω —Å–æ–∑–¥–∞—ë—Ç –ù–û–í–£–Æ –∫–∞–º–ø–∞–Ω–∏—é –∏ –ø–∞—É–∑–∏—Ç –≤—Å–µ —Å—Ç–∞—Ä—ã–µ
- –ö–æ–≥–¥–∞ –µ—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí **Brain Agent** —Å–æ–∑–¥–∞—ë—Ç Ad Sets –≤–Ω—É—Ç—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–∞–º–ø–∞–Ω–∏–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- Brain Agent –ù–ï –ø–∞—É–∑–∏—Ç –¥—Ä—É–≥–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π

---

### **3. –§—Ä–æ–Ω—Ç–µ–Ω–¥ ‚Äî –ù–ï –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù**

‚ùå –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–µ–π—á–∞—Å –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ Supabase –¥–ª—è `account_directions`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –£–±—Ä–∞—Ç—å –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ Supabase
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Backend API: `https://agents.performanteaiagency.com/api/directions`
3. –°–æ–∑–¥–∞—Ç—å `services/directionsApi.ts` —Å –º–µ—Ç–æ–¥–∞–º–∏ API
4. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç DirectionsCard –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

**–§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ—Ä–∞:**
- `DIRECTIONS_FRONTEND_SPEC.md`
- `DIRECTIONS_FRONTEND_INTEGRATION.md`

---

### **4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞**

‚ùå –ù–ï –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:
1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –ó–∞–≥—Ä—É–∑–∫–∞ –∫—Ä–µ–∞—Ç–∏–≤–∞ —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é
3. Brain Agent –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
4. Brain Agent —Å–æ–∑–¥–∞—ë—Ç Ad Sets –≤–Ω—É—Ç—Ä–∏ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üéØ –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Brain Agent** (–∫—Ä–∏—Ç–∏—á–Ω–æ!)

1. –î–æ–±–∞–≤–∏—Ç—å getUserDirections
2. –û–±–Ω–æ–≤–∏—Ç—å llmInput —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
3. –û–±–Ω–æ–≤–∏—Ç—å SYSTEM_PROMPT
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–í—Ä–µ–º—è:** ~2-3 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**

1. –ü–µ—Ä–µ–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ—Ä—É
2. –£–±—Ä–∞—Ç—å Supabase direct access
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å API

**–í—Ä–µ–º—è:** ~1-2 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ—Ä–∞

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –î–µ–ø–ª–æ–π**

1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ Supabase
2. –ó–∞–ø—É—à–∏—Ç—å –∫–æ–¥ –≤ git
3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–í—Ä–µ–º—è:** ~30 –º–∏–Ω—É—Ç

---

## üìä –¢–ï–ö–£–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
Frontend ‚Üí POST /api/directions
    ‚Üì
Backend (agent-service)
    ‚Üì
1. –°–æ–∑–¥–∞—ë—Ç Facebook Campaign —á–µ—Ä–µ–∑ Graph API
2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ account_directions (—Å fb_campaign_id)
    ‚Üì
Response: { success, direction: {...} }
```

### **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —Ä–µ–∫–ª–∞–º—ã (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ):**
```
Frontend ‚Üí –ó–∞–ø—Ä–æ—Å –∫ Brain Agent
    ‚Üì
Brain Agent (agent-brain)
    ‚Üì
1. –ü–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (getUserDirections)
2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤—ã –∫–∞–∂–¥–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç fb_campaign_id –∏–∑ account_directions
   - –°–æ–∑–¥–∞—ë—Ç Ad Sets –í–ù–£–¢–†–ò —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–∞–º–ø–∞–Ω–∏–∏
   - –£–ø—Ä–∞–≤–ª—è–µ—Ç –±—é–¥–∂–µ—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    ‚Üì
Response: { success, actions: [...], report: "..." }
```

---

## üöÄ –§–ê–ô–õ–´ –î–õ–Ø –ö–û–ú–ú–ò–¢–ê

```bash
# –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
migrations/008_account_directions.sql
migrations/009_add_objective_to_directions.sql
services/agent-service/src/routes/directions.ts
DIRECTIONS_FRONTEND_SPEC.md
DIRECTIONS_FRONTEND_INTEGRATION.md
DIRECTIONS_DEPLOY_CHECKLIST.md
DIRECTIONS_STATUS.md

# –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
nginx.conf
services/agent-service/src/server.ts
services/agent-service/src/lib/campaignBuilder.ts (minor: –¥–æ–±–∞–≤–ª–µ–Ω direction_id –≤ —Ç–∏–ø)

# –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å (–ø–æ–∫–∞ –Ω–µ –¥–æ–¥–µ–ª–∞–Ω–æ):
services/agent-brain/src/server.js (—Ç–∞–º —Ç–æ–ª—å–∫–æ reportOnlyMode, –Ω–µ directions)
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–ª—è –¥–µ–ø–ª–æ—è:
- Backend API –¥–ª—è Directions
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

## ‚ùå –ù–ï –≥–æ—Ç–æ–≤–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- Brain Agent (–æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞)
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

**–°—Ç–∞—Ç—É—Å:** Backend API –≥–æ—Ç–æ–≤ –Ω–∞ 100%, Brain Agent –Ω–∞ 0%, Frontend –Ω–∞ 0%
**–î–∞—Ç–∞:** 2025-10-12

