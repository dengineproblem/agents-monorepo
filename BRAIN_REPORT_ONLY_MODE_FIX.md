# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –†–µ–∂–∏–º "–¢–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç" –¥–ª—è –∞–≥–µ–Ω—Ç–∞ Brain

## –ü—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—Ç—á–µ—Ç–∞ –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏—è—Ö
–ê–≥–µ–Ω—Ç Brain –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–ª –æ—Ç—á–µ—Ç, –µ—Å–ª–∏:
- –ó–∞ –≤—á–µ—Ä–∞ –±—ã–ª–∏ –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ —Ä–µ–∫–ª–∞–º–µ
- –ù–æ –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –±—ã–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω—ã (–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã) –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ –∞–≥–µ–Ω—Ç–∞

–í —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏:
- ‚ùå LLM –Ω–µ –≤—ã–∑—ã–≤–∞–ª—Å—è
- ‚ùå –û—Ç—á–µ—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª—Å—è
- ‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –¥–µ–Ω—å —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –õ–∏–º–∏—Ç 25 adsets
Facebook API –≤–æ–∑–≤—Ä–∞—â–∞–ª —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 25 adsets –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
- ‚ùå –ê–≥–µ–Ω—Ç –Ω–µ –≤–∏–¥–µ–ª –≤—Å–µ adsets –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
- ‚ùå –ü—Ä–æ–ø—É—Å–∫–∞–ª –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏
- ‚ùå –ù–µ–≤–µ—Ä–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–ª, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏

## –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –†–µ–∂–∏–º "–¢–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç"

–î–æ–±–∞–≤–ª–µ–Ω **—Ä–µ–∂–∏–º "–¢–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç" (Report-Only Mode)** —Å —Ç—Ä–µ–º—è —É—Ä–æ–≤–Ω—è–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏:

#### A. –ü–æ–¥—Å—á–µ—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–º–ø–∞–Ω–∏–π (—Å—Ç—Ä–æ–∫–∏ 1687-1698)
```javascript
// –°—á–∏—Ç–∞–µ–º –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –ö–ê–ú–ü–ê–ù–ò–ô (–±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ, —á–µ–º adsets)
const totalYesterdaySpendCampaigns = Array.from(byCY.values()).reduce((sum, data) => {
  return sum + (Number(data.spend) || 0);
}, 0);

// –¢–∞–∫–∂–µ —Å—á–∏—Ç–∞–µ–º –Ω–∞ —É—Ä–æ–≤–Ω–µ adsets (–¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)
const totalYesterdaySpendAdsets = Array.from(byY.values()).reduce((sum, data) => {
  return sum + (Number(data.spend) || 0);
}, 0);

// –ë–µ—Ä–µ–º –º–∞–∫—Å–∏–º—É–º (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –Ω–∞ –¥—Ä—É–≥–æ–º –Ω–µ—Ç)
const totalYesterdaySpend = Math.max(totalYesterdaySpendCampaigns, totalYesterdaySpendAdsets);
```

**–ó–∞—á–µ–º:** –ï—Å–ª–∏ –∫–∞–º–ø–∞–Ω–∏–∏ –≤—ã–∫–ª—é—á–µ–Ω—ã, Facebook API –º–æ–∂–µ—Ç –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å insights –Ω–∞ —É—Ä–æ–≤–Ω–µ adsets, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–º–ø–∞–Ω–∏–π.

### –†–µ—à–µ–Ω–∏–µ 2: –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ API

–î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `limit: '500'` –≤–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

#### A. fetchAdsets (—Å—Ç—Ä–æ–∫–∞ 337)
```javascript
async function fetchAdsets(adAccountId, accessToken) {
  const url = new URL(`https://graph.facebook.com/${FB_API_VERSION}/${adAccountId}/adsets`);
  url.searchParams.set('fields','id,name,campaign_id,daily_budget,lifetime_budget,status,effective_status');
  url.searchParams.set('limit', '500'); // Get all adsets, not just first 25 ‚úÖ
  url.searchParams.set('access_token', accessToken);
  return fbGet(url.toString());
}
```

#### B. fetchYesterdayInsights (—Å—Ç—Ä–æ–∫–∞ 347)
```javascript
async function fetchYesterdayInsights(adAccountId, accessToken) {
  // ...
  url.searchParams.set('limit', '500'); // Get all adsets, not just first 25 ‚úÖ
  // ...
}
```

**–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–∂–µ –∏–º–µ–ª–∏ –ª–∏–º–∏—Ç 500:**
- ‚úÖ `fetchInsightsPreset` (—Å—Ç—Ä–æ–∫–∞ 357)
- ‚úÖ `fetchAdLevelInsightsPreset` (—Å—Ç—Ä–æ–∫–∞ 368)
- ‚úÖ `fetchCampaignInsightsPreset` (—Å—Ç—Ä–æ–∫–∞ 379)
- ‚úÖ `fetchCampaigns` (—Å—Ç—Ä–æ–∫–∞ 387)

---

## –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ "–¢–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç"

### 1. –¢—Ä–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—Ç—Ä–∞—Ç –∑–∞ –≤—á–µ—Ä–∞
const totalYesterdaySpend = Array.from(byY.values()).reduce((sum, data) => {
  return sum + (Number(data.spend) || 0);
}, 0);

// –í—Å–µ adsets —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ) - –¥–ª—è –æ—Ç—á–µ—Ç–∞
const allAdsetsWithYesterdaySpend = adsetList.filter(as => {
  const yesterdayData = byY.get(as.id)||{};
  const hasResults = (Number(yesterdayData.spend)||0) > 0 || 
                     (computeLeadsFromActions(yesterdayData).leads||0) > 0;
  return hasResults;
});
```

### 2. –¢—Ä–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π A: –ù–µ—Ç –∑–∞—Ç—Ä–∞—Ç –≤–æ–æ–±—â–µ
```
totalYesterdaySpend === 0 && allAdsetsWithYesterdaySpend.length === 0
```
- ‚úÖ –ù–µ –≤—ã–∑—ã–≤–∞–µ–º LLM
- ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ—Ä–æ—Ç–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∑–∞—Ç—Ä–∞—Ç"

#### –°—Ü–µ–Ω–∞—Ä–∏–π B: –ë—ã–ª–∏ –∑–∞—Ç—Ä–∞—Ç—ã, –Ω–æ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã (–ù–û–í–û–ï!)
```
reportOnlyMode = true
(adsetsWithYesterdayResults.length === 0 && allAdsetsWithYesterdaySpend.length > 0)
```
- ‚úÖ –í—ã–∑—ã–≤–∞–µ–º LLM –¥–ª—è –æ—Ç—á–µ—Ç–∞
- ‚úÖ –í–∫–ª—é—á–∞–µ–º –í–°–ï –∫–∞–º–ø–∞–Ω–∏–∏ —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
- ‚ùå –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ–º –Ω–∏–∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (actions = [])

#### –°—Ü–µ–Ω–∞—Ä–∏–π C: –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏
```
reportOnlyMode = false
(adsetsWithYesterdayResults.length > 0)
```
- ‚úÖ –†–∞–±–æ—Ç–∞–µ–º –∫–∞–∫ –æ–±—ã—á–Ω–æ
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –¥–µ–π—Å—Ç–≤–∏—è

### 3. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥–∏–∫–µ

#### A. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è adsets –¥–ª—è LLM (—Å—Ç—Ä–æ–∫–∏ 1857-1872)
```javascript
.filter(as => {
  const yesterdayData = byY.get(as.id)||{};
  const hasResults = (Number(yesterdayData.spend)||0) > 0 || 
                     (computeLeadsFromActions(yesterdayData).leads||0) > 0;
  
  if (reportOnlyMode) {
    // –†–µ–∂–∏–º "—Ç–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç": –≤–∫–ª—é—á–∞–µ–º –≤—Å–µ adsets —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏
    return hasResults;
  } else {
    // –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º: —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
    if (as.effective_status !== 'ACTIVE') return false;
    return hasResults;
  }
})
```

#### B. –ü–æ–¥—Å—á–µ—Ç totals (—Å—Ç—Ä–æ–∫–∏ 1910-1930)
```javascript
const campaignsWithResults = (campList||[])
  .filter(c => reportOnlyMode ? true : 
               String(c.status||c.effective_status||'').includes('ACTIVE'))
  .map(c=>({ c, y: byCY.get(c.id)||{} }))
  .filter(({y})=> (Number(y.spend)||0) > 0 || 
                  (computeLeadsFromActions(y).leads||0) > 0);
```

#### C. –û—á–∏—Å—Ç–∫–∞ actions –≤ —Ä–µ–∂–∏–º–µ reportOnlyMode (—Å—Ç—Ä–æ–∫–∏ 1821-1830)
```javascript
if (reportOnlyMode) {
  decisions.length = 0;
  touchedCampaignIds.clear();
  fastify.log.info({ 
    where: 'brain_run', 
    phase: 'report_only_mode_decisions_cleared', 
    userId: userAccountId 
  });
}
```

#### D. –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–ª–∞–≥–∞ –≤ llmInput (—Å—Ç—Ä–æ–∫–∞ 1840)
```javascript
account: {
  timezone: ua?.account_timezone || 'Asia/Almaty',
  report_date: date,
  dispatch: !!inputs?.dispatch,
  report_only_mode: reportOnlyMode  // <-- –Ω–æ–≤–æ–µ –ø–æ–ª–µ
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è LLM (—Å—Ç—Ä–æ–∫–∏ 778-802)

–î–æ–±–∞–≤–ª–µ–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª –≤ –Ω–∞—á–∞–ª–æ –ø—Ä–æ–º–ø—Ç–∞:

```
üî¥ –í–ê–ñ–ù–û: –†–ï–ñ–ò–ú "–¢–û–õ–¨–ö–û –û–¢–ß–ï–¢" (REPORT-ONLY MODE)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ö†Ô∏è –°–ò–¢–£–ê–¶–ò–Ø: –ó–∞ –≤—á–µ—Ä–∞ –±—ã–ª–∏ –∑–∞—Ç—Ä–∞—Ç—ã –ø–æ —Ä–µ–∫–ª–∞–º–µ, 
             –ù–û –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –ù–ï–ê–ö–¢–ò–í–ù–´ (–≤—ã–∫–ª—é—á–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º).

üìã –¢–í–û–Ø –ó–ê–î–ê–ß–ê –í –≠–¢–û–ú –†–ï–ñ–ò–ú–ï:
  1. ‚úÖ –°–û–ó–î–ê–¢–¨ –ü–û–õ–ù–´–ô –û–¢–ß–ï–¢ –æ –∑–∞—Ç—Ä–∞—Ç–∞—Ö, –ª–∏–¥–∞—Ö, CPL –∏ QCPL –∑–∞ –≤—á–µ—Ä–∞
  2. ‚úÖ –ü–†–û–ê–ù–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º –∫–∞–º–ø–∞–Ω–∏—è–º (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)
  3. ‚ùå –ù–ï –ü–†–ï–î–õ–ê–ì–ê–¢–¨ –ù–ò–ö–ê–ö–ò–• –î–ï–ô–°–¢–í–ò–ô —Å –∫–∞–º–ø–∞–Ω–∏—è–º–∏/adsets/ads
  4. ‚ùå –ù–ï –†–ï–ö–û–ú–ï–ù–î–û–í–ê–¢–¨ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–æ–≤
  5. ‚ùå actions –º–∞—Å—Å–∏–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–£–°–¢–´–ú: []

üí° –û–ë–™–Ø–°–ù–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Æ:
  ‚Ä¢ –£–ø–æ–º—è–Ω–∏ –≤ –æ—Ç—á–µ—Ç–µ, —á—Ç–æ –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –±—ã–ª–∏ –ù–ï–ê–ö–¢–ò–í–ù–´ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
  ‚Ä¢ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –≤—á–µ—Ä–∞ (–∫–æ–≥–¥–∞ –±—ã–ª–∏ –∑–∞—Ç—Ä–∞—Ç—ã)
  ‚Ä¢ –ü–æ—Ä–µ–∫–æ–º–µ–Ω–¥—É–π –≤–∫–ª—é—á–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏–∏, –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ä–µ–∫–ª–∞–º–∞

‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û: actions –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –ü–£–°–¢–´–ú –ú–ê–°–°–ò–í–û–ú []
planNote –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å: "report_only_mode_inactive_campaigns"
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –∞–≥–µ–Ω—Ç Brain –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ç—Ä–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è:

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ó–∞—Ç—Ä–∞—Ç—ã –∑–∞ –≤—á–µ—Ä–∞ | –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ | LLM | –û—Ç—á–µ—Ç | –î–µ–π—Å—Ç–≤–∏—è |
|----------|------------------|-------------------|-----|-------|----------|
| A | ‚ùå –ù–µ—Ç | ‚ùå –ù–µ—Ç | ‚ùå | ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–π | ‚ùå |
| B | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç | ‚úÖ | ‚úÖ –ü–æ–ª–Ω—ã–π | ‚ùå |
| C | ‚úÖ –î–∞ | ‚úÖ –î–∞ | ‚úÖ | ‚úÖ –ü–æ–ª–Ω—ã–π | ‚úÖ |

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç –∫–µ–π—Å 1: –ë—ã–ª–∏ –∑–∞—Ç—Ä–∞—Ç—ã, –∫–∞–º–ø–∞–Ω–∏–∏ –≤—ã–∫–ª—é—á–µ–Ω—ã
```bash
# 1. –°–æ–∑–¥–∞–π –∫–∞–º–ø–∞–Ω–∏—é —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ –∑–∞ –≤—á–µ—Ä–∞
# 2. –í—ã–∫–ª—é—á–∏ –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏
# 3. –ó–∞–ø—É—Å—Ç–∏ Brain agent
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏, actions = []
```

### –¢–µ—Å—Ç –∫–µ–π—Å 2: –ù–µ—Ç –∑–∞—Ç—Ä–∞—Ç, –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π
```bash
# 1. –í—ã–∫–ª—é—á–∏ –≤—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏
# 2. –£–±–µ–¥–∏—Å—å, —á—Ç–æ –Ω–µ—Ç –∑–∞—Ç—Ä–∞—Ç –∑–∞ –≤—á–µ—Ä–∞
# 3. –ó–∞–ø—É—Å—Ç–∏ Brain agent
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ö–æ—Ä–æ—Ç–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∑–∞—Ç—Ä–∞—Ç", LLM –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
```

### –¢–µ—Å—Ç –∫–µ–π—Å 3: –ï—Å—Ç—å –∑–∞—Ç—Ä–∞—Ç—ã, –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ (–æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º)
```bash
# 1. –°–æ–∑–¥–∞–π –∫–∞–º–ø–∞–Ω–∏—é —Å –∑–∞—Ç—Ä–∞—Ç–∞–º–∏
# 2. –û—Å—Ç–∞–≤—å –∫–∞–º–ø–∞–Ω–∏—é –∞–∫—Ç–∏–≤–Ω–æ–π
# 3. –ó–∞–ø—É—Å—Ç–∏ Brain agent
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç + –∞–Ω–∞–ª–∏–∑ + actions
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```javascript
fastify.log.info({
  where: 'brain_run',
  phase: 'adsets_filtered',
  total_adsets: adsetList.length,
  active_adsets: ...,
  with_yesterday_results: adsetsWithYesterdayResults.length,
  all_with_spend: allAdsetsWithYesterdaySpend.length,  // –Ω–æ–≤–æ–µ
  total_yesterday_spend: totalYesterdaySpend,           // –Ω–æ–≤–æ–µ
});
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

- ‚úÖ `services/agent-brain/src/server.js` (—Å—Ç—Ä–æ–∫–∏ 1656-2009)

## –í–µ—Ä—Å–∏—è

- **–î–æ**: v1.2 (–ø—Ä–æ–ø—É—Å–∫–∞–ª –æ—Ç—á–µ—Ç—ã –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏—è—Ö)
- **–ü–æ—Å–ª–µ**: v1.3 (—Ä–µ–∂–∏–º "—Ç–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç")

