# üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω–æ–º

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. **Audience.DuplicateAdSetWithAudience** - –¥—É–±–ª—å ad set —Å –Ω–æ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π
2. **Workflow.DuplicateAndPauseOriginal** - —Ä–µ–∞–Ω–∏–º–∞—Ü–∏—è –∫–∞–º–ø–∞–Ω–∏–∏
3. **Workflow.DuplicateKeepOriginalActive** - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìã 4-—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞** ‚öôÔ∏è

```bash
# 1. –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
sed -i '' 's/BRAIN_TEST_MODE=false/BRAIN_TEST_MODE=true/' docker-compose.yml
sed -i '' 's/FB_VALIDATE_ONLY=false/FB_VALIDATE_ONLY=true/' docker-compose.yml

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose build --no-cache
docker-compose up -d

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
curl localhost:7080/api/brain/llm-ping
```

---

### **–≠—Ç–∞–ø 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º** üîç

–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ agent-service –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π:

```bash
chmod +x test-actions-validation.sh
./test-actions-validation.sh
```

**–û–∂–∏–¥–∞–Ω–∏–µ:** –í—Å–µ 3 —Ç–µ—Å—Ç–∞ –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å `executionId` (—É—Å–ø–µ—Ö) –∏–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—à–∏–±–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

---

### **–≠—Ç–∞–ø 3: –ü—Ä–æ–≤–æ–∫–∞—Ü–∏—è LLM** üéØ

–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ –Ω—É–∂–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö:

```bash
chmod +x test-duplication-tools.sh
./test-duplication-tools.sh
```

**–ü—Ä–æ–≤–µ—Ä—è–µ–º:**
- ‚úÖ LLM —É–ø–æ–º–∏–Ω–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `planNote`
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ `actions` 
- ‚úÖ `reportText` —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π
- ‚úÖ Agent-service –ø—Ä–∏–Ω–∏–º–∞–µ—Ç actions (validation passed)

---

### **–≠—Ç–∞–ø 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** üöÄ

**–í–∞–∂–Ω–æ:** –≠—Ç–æ—Ç —ç—Ç–∞–ø –¥–µ–ª–∞–µ–º —Å **–û–î–ù–û–ô —Ç–µ—Å—Ç–æ–≤–æ–π –∫–∞–º–ø–∞–Ω–∏–µ–π**, –∫–æ—Ç–æ—Ä—É—é –Ω–µ –∂–∞–ª–∫–æ!

```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞–º–ø–∞–Ω–∏—é –≤ Facebook Ads Manager
#    –ù–∞–∑–≤–∞—Ç—å: "TEST DUPLICATION - DELETE ME"

# 2. –í—ã–∫–ª—é—á–∏—Ç—å FB_VALIDATE_ONLY –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
sed -i '' 's/FB_VALIDATE_ONLY=true/FB_VALIDATE_ONLY=false/' docker-compose.yml
docker-compose up -d agent-service

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç —Å dispatch=true –Ω–∞ –¢–ï–°–¢–û–í–û–ô –∫–∞–º–ø–∞–Ω–∏–∏
curl -X POST localhost:7080/api/brain/run \
  -H 'Content-Type: application/json' \
  -d '{
    "userAccountId": "...",
    "inputs": {
      "dispatch": true,
      "testCampaignId": "TEST_CAMPAIGN_ID"
    }
  }'

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Facebook Ads Manager:
#    - –°–æ–∑–¥–∞–Ω –ª–∏ –¥—É–±–ª—å –∫–∞–º–ø–∞–Ω–∏–∏/ad set?
#    - –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏?
#    - –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø–∞—É–∑–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)?

# 5. –£–î–ê–õ–ò–¢–¨ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞–º–ø–∞–Ω–∏—é –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
```

---

## üéØ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω–æ–º

- [ ] –í—Å–µ 3 —Ç–∏–ø–∞ –¥–µ–π—Å—Ç–≤–∏–π –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –≤ agent-service
- [ ] LLM –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç actions –ø—Ä–∏ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–∏
- [ ] –¢–µ—Å—Ç –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ
- [ ] –õ–æ–≥–∏ agent-service –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –æ—à–∏–±–æ–∫
- [ ] Facebook API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥–∞–∫—à–Ω–∞ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω—ã:
  ```yaml
  BRAIN_TEST_MODE=false
  FB_VALIDATE_ONLY=false
  BRAIN_DRY_RUN=false
  ```

---

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å?

### –ü—Ä–æ–±–ª–µ–º–∞: LLM –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–ª–æ—Ö–∏–µ/—Ö–æ—Ä–æ—à–∏–µ –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–∞
2. SYSTEM_PROMPT –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
3. LLM –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç —Å–∏—Ç—É–∞—Ü–∏—é –∏–Ω–∞—á–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `planNote` –∏ `reportText` - LLM –æ–±—ä—è—Å–Ω—è–µ—Ç —Å–≤–æ–∏ —Ä–µ—à–µ–Ω–∏—è
- –£–≤–µ–ª–∏—á–∏—Ç—å `overrideCPL` –¥–ª—è –±–æ–ª–µ–µ —è–≤–Ω–æ–π –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SYSTEM_PROMPT –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–∞–≤–∏–ª –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: Agent-service –æ—Ç–∫–ª–æ–Ω—è–µ—Ç actions

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–Ω–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ agent-service: `docker logs agents-monorepo-agent-service-1`
- –°—Ä–∞–≤–Ω–∏—Ç—å —Å —Å—Ö–µ–º–æ–π –≤ `src/actions/schema.ts`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å manifest.json

### –ü—Ä–æ–±–ª–µ–º–∞: Facebook API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ —É access_token
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã API
3. –ö–∞–º–ø–∞–Ω–∏—è/ad set –≤ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–º —Å—Ç–∞—Ç—É—Å–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å permissions —Ç–æ–∫–µ–Ω–∞ –≤ Facebook Graph API Explorer
- –í–∫–ª—é—á–∏—Ç—å `FB_VALIDATE_ONLY=true` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–∏/ad set

---

## üìä –ú–∞—Ç—Ä–∏—Ü–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

| –°—Ü–µ–Ω–∞—Ä–∏–π | overrideCPL | –û–∂–∏–¥–∞–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ | –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞ |
|----------|-------------|-------------------|-----------------|
| 1 –ø—Ä–æ–≤–∞–ª | –≤–µ–±–∏–Ω–∞—Ä: 8.00 | Audience.DuplicateAdSetWithAudience | Action –≤ —Å–ø–∏—Å–∫–µ |
| –í—Å–µ –ø–ª–æ—Ö–∏–µ | –≤—Å–µ: >8.00 | Best-of-bad –ò–õ–ò Duplicate+Pause | HS –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω |
| –í—Å–µ —Ö–æ—Ä–æ—à–∏–µ | –≤—Å–µ: <2.00 | Scale (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–æ–≤) –ò–õ–ò Duplicate+Keep | –ë—é–¥–∂–µ—Ç—ã —É–≤–µ–ª–∏—á–µ–Ω—ã |

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–ù–ò–ö–û–ì–î–ê –ù–ï:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å `dispatch=true` –Ω–∞ –±–æ–µ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏—è—Ö –±–µ–∑ `FB_VALIDATE_ONLY=true`
- –û—Å—Ç–∞–≤–ª—è—Ç—å `BRAIN_TEST_MODE=true` –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ
- –ö–æ–º–º–∏—Ç–∏—Ç—å API –∫–ª—é—á–∏ –≤ git

**–í–°–ï–ì–î–ê:**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –∫–∞–º–ø–∞–Ω–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–Ω-–∑–∞–ø—É—Å–∫–æ–º
- –î–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞–º–ø–∞–Ω–∏–π –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏
