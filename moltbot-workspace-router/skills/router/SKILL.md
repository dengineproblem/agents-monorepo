---
name: router
description: –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ specialist –∞–≥–µ–Ω—Ç–∞–º
priority: 900
moltbot:
  always: true
  requires:
    env:
      - AGENT_SERVICE_URL
---

# Router Skill ‚Äî –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∫ Specialists

–≠—Ç–æ—Ç skill –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ specialist –∞–≥–µ–Ω—Ç–∞–º –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ router –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω—É–∂–Ω–æ–≥–æ specialist.

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: routeToSpecialist

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ç—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª –Ω—É–∂–Ω–æ–≥–æ specialist (—á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤), –∏—Å–ø–æ–ª—å–∑—É–π —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞–ø—Ä–æ—Å–∞.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- **specialist** (string, required) ‚Äî –∏–º—è specialist –∞–≥–µ–Ω—Ç–∞:
  - `facebook-ads` ‚Äî –¥–ª—è —Ä–µ–∫–ª–∞–º—ã Facebook/Instagram
  - `creatives` ‚Äî –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
  - `crm` ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–∏–¥–∞–º–∏ –∏ CRM
  - `tiktok` ‚Äî –¥–ª—è —Ä–µ–∫–ª–∞–º—ã TikTok
  - `onboarding` ‚Äî –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **message** (string, required) ‚Äî –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **telegramChatId** (string, required) ‚Äî Telegram Chat ID –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –í—ã–∑–æ–≤ —á–µ—Ä–µ–∑ curl

```bash
curl -s -X POST http://agent-service:8082/api/moltbot/route \
  -H "Content-Type: application/json" \
  -d '{
    "specialist": "facebook-ads",
    "message": "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é",
    "telegramChatId": "313145981"
  }'
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```
–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é
```

**–¢–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è:**
1. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—à—å –∑–∞–ø—Ä–æ—Å ‚Üí –æ–ø—Ä–µ–¥–µ–ª—è–µ—à—å –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
2. –û–ø—Ä–µ–¥–µ–ª—è–µ—à—å specialist ‚Üí `facebook-ads`
3. –í—ã–∑—ã–≤–∞–µ—à—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:

```bash
curl -s -X POST http://agent-service:8082/api/moltbot/route \
  -H "Content-Type: application/json" \
  -d '{
    "specialist": "facebook-ads",
    "message": "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é",
    "telegramChatId": "313145981"
  }'
```

### Response format

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç specialist –∞–≥–µ–Ω—Ç–∞ –Ω–∞–ø—Ä—è–º—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

```json
{
  "response": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π:\n\n–ö–∞–º–ø–∞–Ω–∏—è \"Yoga Classes\":\n- –ü–æ–∫–∞–∑—ã: 10,234\n- –ö–ª–∏–∫–∏: 456\n- CTR: 4.45%\n- –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: $123.45"
}
```

### –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–ù–ï –≤—ã–∑—ã–≤–∞–π —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –µ—Å–ª–∏:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –ø–æ–∑–¥–æ—Ä–æ–≤–∞–ª—Å—è ("–ü—Ä–∏–≤–µ—Ç")
- –ó–∞–ø—Ä–æ—Å –Ω–µ—è—Å–µ–Ω –∏ —Ç—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è
- –¢—ã —Å–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è –≤ –≤—ã–±–æ—Ä–µ specialist

**–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö** –≤–µ—Ä–Ω–∏ default routing: `ROUTE: facebook-ads`

### Error handling

–ï—Å–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É:
1. –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è specialist name
2. –£–±–µ–¥–∏—Å—å —á—Ç–æ –ø–µ—Ä–µ–¥–∞–Ω telegramChatId
3. –ü–æ–ø—Ä–æ–±—É–π fallback –Ω–∞ `facebook-ads` specialist

### –í–∞–∂–Ω–æ

**–í–°–ï–ì–î–ê** –ø–µ—Ä–µ–¥–∞–≤–∞–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä `message`. –ù–µ –¥–æ–±–∞–≤–ª—è–π —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è.

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```json
{
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é"
}
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```json
{
  "message": "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞ –Ω–µ–¥–µ–ª—é"
}
```

## Flow –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

```
1. Router Agent –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ‚Üì
2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
   ‚Üì
3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç specialist (–Ω–∞–ø—Ä–∏–º–µ—Ä, "facebook-ads")
   ‚Üì
4. –í—ã–∑—ã–≤–∞–µ—Ç routeToSpecialist —Å specialist + message
   ‚Üì
5. Specialist Agent –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å —Å –ø–æ–ª–Ω—ã–º–∏ skills
   ‚Üì
6. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

## –ü—Ä–∏–º–µ—Ä—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏

| –ó–∞–ø—Ä–æ—Å | Specialist | Curl –∫–æ–º–∞–Ω–¥–∞ |
|--------|-----------|--------------|
| "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É" | facebook-ads | `curl ... -d '{"specialist": "facebook-ads", "message": "...", "telegramChatId": "..."}` |
| "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫—Ä–µ–∞—Ç–∏–≤" | creatives | `curl ... -d '{"specialist": "creatives", "message": "...", "telegramChatId": "..."}` |
| "–ù–æ–≤—ã–µ –ª–∏–¥—ã" | crm | `curl ... -d '{"specialist": "crm", "message": "...", "telegramChatId": "..."}` |
| "/onboarding" | onboarding | `curl ... -d '{"specialist": "onboarding", "message": "...", "telegramChatId": "..."}` |

## –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è specialist:
1. –í—ã–∑–æ–≤–∏ `routeToSpecialist`
2. –ü–µ—Ä–µ–¥–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
3. –í—Å—ë.

Specialist agent —Å–¥–µ–ª–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É.
