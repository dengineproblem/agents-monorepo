# ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û: UNUSED CREATIVES –°–ò–°–¢–ï–ú–ê

## üéØ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### 1. **Scoring Agent** - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

**–§–∞–π–ª:** `services/agent-brain/src/scoring.js`

#### ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ:

```javascript
// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö creative_id –∏–∑ Facebook
async function getActiveCreativeIds(adAccountId, accessToken)

// –õ–æ–≥–∏–∫–∞ –≤ runScoringAgent():
const activeCreativeIds = await getActiveCreativeIds(ad_account_id, access_token);

const unusedCreatives = [];
for (const uc of userCreatives) {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º: –ù–ò –û–î–ò–ù –∏–∑ fb_creative_id_* –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö ads
  if (isUnused) {
    unusedCreatives.push({ 
      id, title, recommended_objective, created_at, ...
    });
  }
}

// –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
const scoringRawData = {
  adsets: adsetsWithTrends,
  ready_creatives: readyCreatives,
  unused_creatives: unusedCreatives  // üÜï –ù–û–í–û–ï!
};
```

---

### 2. **Brain Agent Prompt** - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

**–§–∞–π–ª:** `services/agent-brain/src/server.js`

#### üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ:

**–°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•:**
```
scoring: {
  summary: { ... },
  items: [ ... ],
  active_creatives_ready: [ ... ],
  unused_creatives: [ ... ],  // üÜï –ù–û–í–û–ï!
  recommendations_for_brain: [ ... ]
}
```

**–ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø LLM:**

‚ùå **–£–î–ê–õ–ï–ù–û:**
- –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ "—É—Ç—Ä–æ" –∏ "created_at —Å–µ–≥–æ–¥–Ω—è/–≤—á–µ—Ä–∞"
- –ù–µ—Ç–æ—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–π

‚úÖ **–î–û–ë–ê–í–õ–ï–ù–û:**
```
3. **–ù–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∫—Ä–µ–∞—Ç–∏–≤—ã (–ö–õ–Æ–ß–ï–í–û–ï!)**:
   - –ï—Å–ª–∏ –≤ unused_creatives –µ—Å—Ç—å –∫—Ä–µ–∞—Ç–∏–≤—ã ‚Üí —Ä–∞—Å—Å–º–æ—Ç—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ù–û–í–û–ô –∫–∞–º–ø–∞–Ω–∏–∏ 
     —á–µ—Ä–µ–∑ CreateCampaignWithCreative –í–ú–ï–°–¢–û –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
   - –≠—Ç–æ –¥–∞–µ—Ç —à–∞–Ω—Å —Ç–µ–∫—É—â–∏–º –∫–∞–º–ø–∞–Ω–∏—è–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ + —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π 
     –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏
```

**CreateCampaignWithCreative:**
```
–ö–û–ì–î–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨:
(1) –µ—Å–ª–∏ –≤ scoring.unused_creatives –µ—Å—Ç—å –∫—Ä–µ–∞—Ç–∏–≤—ã ‚Äî —Å–æ–∑–¥–∞–π –∫–∞–º–ø–∞–Ω–∏—é –í–ú–ï–°–¢–û 
    –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—è recommended_objective
(2) –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ —Ç–µ–∫—É—â–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏ ‚Äî —Å–æ–∑–¥–∞–π –Ω–æ–≤—É—é 
    –≤–º–µ—Å—Ç–æ –∞–ø–∞ –±—é–¥–∂–µ—Ç–∞
```

**Fallback –¥–∞–Ω–Ω—ã–µ:**
```javascript
scoringOutput = {
  // ...
  unused_creatives: [],  // üÜï –ù–û–í–û–ï!
  // ...
};
```

---

## üìä –õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ "–Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ" –∫—Ä–µ–∞—Ç–∏–≤–∞:

1. ‚úÖ `is_active = true`
2. ‚úÖ `status = 'ready'`
3. ‚úÖ –•–æ—Ç—è –±—ã –æ–¥–∏–Ω `fb_creative_id_*` –∑–∞–ø–æ–ª–Ω–µ–Ω
4. ‚úÖ **–ù–ò –û–î–ò–ù** –∏–∑ `fb_creative_id_*` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö ads

### –ü—Ä–∏–º–µ—Ä:

```
user_creatives:
- –ö—Ä–µ–∞—Ç–∏–≤ A: fb_creative_id_whatsapp="123" ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Ad #1 ‚ùå
- –ö—Ä–µ–∞—Ç–∏–≤ B: fb_creative_id_whatsapp="456" ‚Üí –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚úÖ
- –ö—Ä–µ–∞—Ç–∏–≤ C: fb_creative_id_whatsapp="789" ‚Üí –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚úÖ

unused_creatives: [B, C]  // –¢–æ–ª—å–∫–æ —ç—Ç–∏ –¥–≤–∞
```

---

## üöÄ –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–û:
```
Brain Agent:
  ‚îú‚îÄ Scoring –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
  ‚îú‚îÄ –†–µ—à–µ–Ω–∏–µ: –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å Campaign X
  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: Campaign X (old) –∫–æ–Ω–∫—É—Ä–∏—Ä—É–µ—Ç —Å Campaign X (new)
```

### –ü–û–°–õ–ï:
```
Brain Agent:
  ‚îú‚îÄ Scoring –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: 
  ‚îÇ   ‚îú‚îÄ –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
  ‚îÇ   ‚îî‚îÄ –µ—Å—Ç—å unused_creatives: [–ö—Ä–µ–∞—Ç–∏–≤ B, –ö—Ä–µ–∞—Ç–∏–≤ C]
  ‚îú‚îÄ –†–µ—à–µ–Ω–∏–µ: CreateCampaignWithCreative(–ö—Ä–µ–∞—Ç–∏–≤ B, WhatsApp)
  ‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç:
      ‚îú‚îÄ Campaign X –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ ‚úÖ
      ‚îî‚îÄ Campaign "NEW" —Å—Ç–∞—Ä—Ç—É–µ—Ç —Å –Ω–æ–≤—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º ‚úÖ
```

---

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

1. ‚úÖ `services/agent-brain/src/scoring.js`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ `getActiveCreativeIds()`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `unusedCreatives`
   - –û–±–Ω–æ–≤–ª–µ–Ω `scoringRawData` —Å –ø–æ–ª–µ–º `unused_creatives`

2. ‚úÖ `services/agent-brain/src/server.js`
   - –û–±–Ω–æ–≤–ª–µ–Ω `SYSTEM_PROMPT` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ `unused_creatives`
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è `CreateCampaignWithCreative`
   - –î–æ–±–∞–≤–ª–µ–Ω `unused_creatives: []` –≤ fallback –¥–∞–Ω–Ω—ã–µ

3. ‚úÖ `UNUSED_CREATIVES.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
4. ‚úÖ `UNUSED_CREATIVES_SUMMARY.md` - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

---

## üß™ –ö–ê–ö –¢–ï–°–¢–ò–†–û–í–ê–¢–¨

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Scoring Agent:

```bash
curl -X POST http://localhost:9091/api/scoring/run \
  -H "Content-Type: application/json" \
  -d '{"user_id": "YOUR_USER_ID"}'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "unused_creatives": [
    {
      "id": "...",
      "title": "...",
      "recommended_objective": "WhatsApp",
      "created_at": "..."
    }
  ]
}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Brain Agent:

```bash
curl -X POST http://localhost:9091/api/brain/run \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "YOUR_USER_ID",
    "dispatch": false
  }'
```

**Brain Agent –¥–æ–ª–∂–µ–Ω:**
- –í–∏–¥–µ—Ç—å `scoring.unused_creatives` –≤ LLM input
- –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞–º–ø–∞–Ω–∏–∏ –≤–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `recommended_objective` –∏–∑ unused_creatives

---

## ‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê

1. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è** - –¢–µ–∫—É—â–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö –∫—Ä–µ–∞—Ç–∏–≤–æ–≤
3. **–ò–∑–±–µ–∂–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏** - –ù–µ—Ç –±–æ—Ä—å–±—ã –∑–∞ –æ–¥–Ω—É –∞—É–¥–∏—Ç–æ—Ä–∏—é
4. **–î–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏–π** - –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—Ä–µ–∞—Ç–∏–≤–æ–≤

---

## üìÖ –°–¢–ê–¢–£–°

‚úÖ **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å agent-brain
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π —á–µ—Ä–µ–∑ CreateCampaignWithCreative

---

üìÖ **–î–∞—Ç–∞:** 5 –æ–∫—Ç—è–±—Ä—è 2025  
üîß **–í–µ—Ä—Å–∏—è:** 2.0  
‚úÖ **–°—Ç–∞—Ç—É—Å:** Implemented & Documented
